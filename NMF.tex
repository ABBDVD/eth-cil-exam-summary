
\section{Non-Negative Matrix Factorization (NMF) / pLSA}
\begin{compactdesc}
	\item[Context Model:] $p(w | d) = \sum_{z=1}^K p(w | z) p(z | d)$
	\item[Conditional independence assumption ($*$):] $p(w|d) = \sum_z p(w,z|d) = \sum_z p(w|d,z)p(z|d) \stackrel{*}{=} \sum_z p(w|z)p(z|d)$
	\item[Symmetric parameterization:] $p(w, d) = \sum_z p(z)p(w | z) p(d | z)$
\end{compactdesc}

\subsection*{EM for pLSA:}
\begin{compactenum}[\color{red} 1.]
  \item Log-Likelihood: $L(\mathbf{U}, \mathbf{V}) = \sum_{i,j} x_{i,j}\log p(w_j|d_i) = \break \sum_{(i,j) \in X} \log \sum_{z=1}^K p(w_j|z)p(z|d_i)$
	\item E-Step (optimal q): $q_{zij} = \frac{p(w_j|z)p(z|d_i)}{\sum_{k=1}^K p(w_j|k)p(k|d_i)} := \frac{v_{zj}u_{zi}}{\sum_{k=1}^K v_{kj}u_{ki}}$
	\item M-Steps: $p(z|d_i) = \frac{\sum_j x_{ij}q_{zij}}{\sum_j x_{ij}}\hspace{10pt}\&\hspace{10pt} p(w_j|z) = \frac{\sum_i x_{ij}q_{zij}}{\sum_{i,l}x_{il}q_{zil}}$
\end{compactenum}

\subsection*{NMF Algorithm for quadratic cost function}
\begin{inparaitem}[\color{red}\textbullet]
	\item $\mathbf{X} \in \mathbb{Z}^{N \times M}_{\geq 0}$
	\item NMF: $\mathbf{X} \approx \mathbf{U^\top V}, x_{ij} = \sum_z u_{zi}v_{zj} = \langle \mathbf{u}_i, \mathbf{v}_j \rangle$
\end{inparaitem}

$\min_{\mathbf{U}, \mathbf{V}} J(\mathbf{U}, \mathbf{V}) = \frac{1}{2} \|\mathbf{X} - \mathbf{U}^\top\mathbf{V}\|_F^2$ s.t. $\forall i,j,z~u_{zi},v_{zj} \geq 0 $

\begin{inparaenum}[\color{red} 1.]
	\item init: $\mathbf{U}, \mathbf{V} = rand()$
	\item repeat for $\mathit{maxIters}$:
	\item update $\mathbf{U}$: $(\mathbf{VV}^\top)\mathbf{U} = \mathbf{VX}^\top$
	\item project $u_{zi} = \max \{ 0, u_{zi} \}$
	\item update $\mathbf{V}$: $(\mathbf{UU}^\top)\mathbf{V} = \mathbf{UX}$
	\item project $v_{zj} = \max \{ 0, v_{zj} \}$
\end{inparaenum}
